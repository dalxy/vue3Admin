<template>
  <div>
    <h1>test</h1>
    <test2></test2>
  </div>
</template>
<script lang="ts" setup>
import test2 from "./test2/index.vue";
const b = [
  {
    id: 82567,
    requestId: "",
    eventName: "快速技术活动",
    eventOrderNumber: "XY208924288961926874",
    eventOrderName: "L6T79T2E7NP007347底盘线束卡扣检查及更换",
    eventOrderType: 2,
    eventOrderStatus: 1,
    eventOrderLevel: 3,
    userCode: "iam_3e1136926cd6",
    summaryTitle: "",
    summary: "【基本信息",
    summaryDynamicField: '[{"deSsta}]',
    eventOrderData: "[",
    parentNumber: "XY208924288961926864",
    endTime: -28800000,
    exceptionStatus: 0,
    noticeConfig: "",
    createTime: 1703752194000,
    updateTime: 1703753494000,
    sourceNumber: "zx1228S2023120002",
    eventOrderSecondType: "chainForQualityRecall",
    assignRuleConfig: "",
    measureType: 3,
    measureTypeStr: "软件问题",
    eventPlanInfoList: [
      {
        planCode: "T851001",
        planName: "问题排查及维修",
        settlementTypeFinish: false,
        perceptionSymptomFinish: false,
        repairModelList: [
          {
            budgetName: "底盘线束问题卡扣更换",
            carEdition: "极越01（通用）",
            carModel: "极越01",
            count: "1",
            planCode: "T851001",
            planName: "问题排查及维修",
            planType: "1",
            planTypeStr: "工时",
            workTimeCode: "B522027_MC1123H",
            workTimeName: "左侧后视镜，喷漆",
            perceptionSymptomTypeValue: "1",
            perceptionSymptomTypeName: "动力系统",
            perceptionSymptomCode: "CPS9999",
            perceptionSymptomName: "动力测试",
            settlementTypeId: null,
            settlementTypeName: null,
            settlementType: null,
            settlementTypeDesc: null,
            select: false,
            costCenterNumber: "",
            costCenterDesc: null,
            planFinish: false,
            settlementTypeFinish: false,
            perceptionSymptomFinish: false
          },
          {
            budgetName: "底盘线束问题卡扣更换",
            carEdition: "极越01（通用）",
            carModel: "极越01",
            count: "1",
            planCode: "T851001",
            planName: "问题排查及维修",
            planType: "1",
            planTypeStr: "工时",
            workTimeCode: "B522027_MC1123H",
            workTimeName: "左侧后视镜，喷漆",
            perceptionSymptomTypeValue: "1",
            perceptionSymptomTypeName: "动力系统",
            perceptionSymptomCode: "CPS9999",
            perceptionSymptomName: "动力测试",
            settlementTypeId: null,
            settlementTypeName: null,
            settlementType: null,
            settlementTypeDesc: null,
            select: false,
            costCenterNumber: "",
            costCenterDesc: null,
            planFinish: false,
            settlementTypeFinish: false,
            perceptionSymptomFinish: false
          }
        ]
      },
      {
        planCode: "T851001",
        planName: "问题排查及维修",
        settlementTypeFinish: false,
        perceptionSymptomFinish: false,
        repairModelList: [
          {
            budgetName: "底盘线束问题卡扣更换",
            carEdition: "极越01（通用）",
            carModel: "极越01",
            count: "1",
            planCode: "T851001",
            planName: "问题排查及维修",
            planType: "1",
            planTypeStr: "工时",
            workTimeCode: "B522027_MC1123H",
            workTimeName: "左侧后视镜，喷漆",
            perceptionSymptomTypeValue: "1",
            perceptionSymptomTypeName: "动力系统",
            perceptionSymptomCode: "CPS9999",
            perceptionSymptomName: "动力测试",
            settlementTypeId: null,
            settlementTypeName: null,
            settlementType: null,
            settlementTypeDesc: null,
            select: false,
            costCenterNumber: "",
            costCenterDesc: null,
            planFinish: false,
            settlementTypeFinish: false,
            perceptionSymptomFinish: false
          },
          {
            budgetName: "底盘线束问题卡扣更换",
            carEdition: "极越01（通用）",
            carModel: "极越01",
            count: "1",
            planCode: "T851001",
            planName: "问题排查及维修",
            planType: "1",
            planTypeStr: "工时",
            workTimeCode: "B522027_MC1123H",
            workTimeName: "左侧后视镜，喷漆",
            perceptionSymptomTypeValue: "1",
            perceptionSymptomTypeName: "动力系统",
            perceptionSymptomCode: "CPS9999",
            perceptionSymptomName: "动力测试",
            settlementTypeId: null,
            settlementTypeName: null,
            settlementType: null,
            settlementTypeDesc: null,
            select: false,
            costCenterNumber: "",
            costCenterDesc: null,
            planFinish: false,
            settlementTypeFinish: false,
            perceptionSymptomFinish: false
          }
        ]
      }
    ]
  },
  {
    id: 82567,
    requestId: "",
    eventName: "快速技术活动",
    eventOrderNumber: "XY208924288961926874",
    eventOrderName: "L6T79T2E7NP007347底盘线束卡扣检查及更换",
    eventOrderType: 2,
    eventOrderStatus: 1,
    eventOrderLevel: 3,
    userCode: "iam_3e1136926cd6",
    summaryTitle: "",
    summary: "【基本信息",
    summaryDynamicField: '[{"deSsta}]',
    eventOrderData: "[",
    parentNumber: "XY208924288961926864",
    endTime: -28800000,
    exceptionStatus: 0,
    noticeConfig: "",
    createTime: 1703752194000,
    updateTime: 1703753494000,
    sourceNumber: "zx1228S2023120002",
    eventOrderSecondType: "chainForQualityRecall",
    assignRuleConfig: "",
    measureType: 3,
    measureTypeStr: "软件问题",
    eventPlanInfoList: [
      {
        planCode: "T851001",
        planName: "问题排查及维修",
        settlementTypeFinish: false,
        perceptionSymptomFinish: false,
        repairModelList: [
          {
            budgetName: "底盘线束问题卡扣更换",
            carEdition: "极越01（通用）",
            carModel: "极越01",
            count: "1",
            planCode: "T851001",
            planName: "问题排查及维修",
            planType: "1",
            planTypeStr: "工时",
            workTimeCode: "B522027_MC1123H",
            workTimeName: "左侧后视镜，喷漆",
            perceptionSymptomTypeValue: "1",
            perceptionSymptomTypeName: "动力系统",
            perceptionSymptomCode: "CPS9999",
            perceptionSymptomName: "动力测试",
            settlementTypeId: null,
            settlementTypeName: null,
            settlementType: null,
            settlementTypeDesc: null,
            select: false,
            costCenterNumber: "",
            costCenterDesc: null,
            planFinish: false,
            settlementTypeFinish: false,
            perceptionSymptomFinish: false
          },
          {
            budgetName: "底盘线束问题卡扣更换",
            carEdition: "极越01（通用）",
            carModel: "极越01",
            count: "1",
            planCode: "T851001",
            planName: "问题排查及维修",
            planType: "1",
            planTypeStr: "工时",
            workTimeCode: "B522027_MC1123H",
            workTimeName: "左侧后视镜，喷漆",
            perceptionSymptomTypeValue: "1",
            perceptionSymptomTypeName: "动力系统",
            perceptionSymptomCode: "CPS9999",
            perceptionSymptomName: "动力测试",
            settlementTypeId: null,
            settlementTypeName: null,
            settlementType: null,
            settlementTypeDesc: null,
            select: false,
            costCenterNumber: "",
            costCenterDesc: null,
            planFinish: false,
            settlementTypeFinish: false,
            perceptionSymptomFinish: false
          }
        ]
      },
      {
        planCode: "T851001",
        planName: "问题排查及维修",
        settlementTypeFinish: false,
        perceptionSymptomFinish: false,
        repairModelList: [
          {
            budgetName: "底盘线束问题卡扣更换",
            carEdition: "极越01（通用）",
            carModel: "极越01",
            count: "1",
            planCode: "T851001",
            planName: "问题排查及维修",
            planType: "1",
            planTypeStr: "工时",
            workTimeCode: "B522027_MC1123H",
            workTimeName: "左侧后视镜，喷漆",
            perceptionSymptomTypeValue: "1",
            perceptionSymptomTypeName: "动力系统",
            perceptionSymptomCode: "CPS9999",
            perceptionSymptomName: "动力测试",
            settlementTypeId: null,
            settlementTypeName: null,
            settlementType: null,
            settlementTypeDesc: null,
            select: false,
            costCenterNumber: "",
            costCenterDesc: null,
            planFinish: false,
            settlementTypeFinish: false,
            perceptionSymptomFinish: false
          },
          {
            budgetName: "底盘线束问题卡扣更换",
            carEdition: "极越01（通用）",
            carModel: "极越01",
            count: "1",
            planCode: "T851001",
            planName: "问题排查及维修",
            planType: "1",
            planTypeStr: "工时",
            workTimeCode: "B522027_MC1123H",
            workTimeName: "左侧后视镜，喷漆",
            perceptionSymptomTypeValue: "1",
            perceptionSymptomTypeName: "动力系统",
            perceptionSymptomCode: "CPS9999",
            perceptionSymptomName: "动力测试",
            settlementTypeId: null,
            settlementTypeName: null,
            settlementType: null,
            settlementTypeDesc: null,
            select: false,
            costCenterNumber: "",
            costCenterDesc: null,
            planFinish: false,
            settlementTypeFinish: false,
            perceptionSymptomFinish: false
          }
        ]
      }
    ]
  }
];
interface WorkTimeCheckItem {
  workTimeCode: string;
  count: string;
  settlementTypeId: string;
  settlementTypeName: string;
  perceptionSymptomCode: string;
  perceptionSymptomName: string;
}

interface EventOrderCheckItem {
  eventOrderNumber: string;
  eventStatus: 0 | 1;
  planCode: string;
  planName: string;
  eventName: string;
  sourceNumber: string;
  workTimeCheckList: WorkTimeCheckItem[];
}

// 转换函数
function convertBToA(bArray: any[]): EventOrderCheckItem[] {
  return bArray.map((bItem) => {
    const workTimeCheckList: WorkTimeCheckItem[] =
      bItem.eventPlanInfoList.flatMap((planInfo) => {
        return planInfo.repairModelList.map((repairModel) => {
          return {
            workTimeCode: repairModel.workTimeCode,
            count: repairModel.count,
            settlementTypeId: repairModel.settlementTypeId || "",
            settlementTypeName: repairModel.settlementTypeName || "",
            perceptionSymptomCode: repairModel.perceptionSymptomCode,
            perceptionSymptomName: repairModel.perceptionSymptomName
          };
        });
      });

    return {
      eventOrderNumber: bItem.eventOrderNumber,
      eventStatus: bItem.eventOrderStatus === 1 ? 1 : 0,
      planCode: bItem.eventPlanInfoList[0].planCode,
      planName: bItem.eventPlanInfoList[0].planName,
      eventName: bItem.eventName,
      sourceNumber: bItem.sourceNumber,
      workTimeCheckList: workTimeCheckList
    };
  });
}

// 使用转换函数
const convertedArrayA: EventOrderCheckItem[] = convertBToA(b);

// 输出转换后的结果
console.log(convertedArrayA);
</script>
